const e=document.querySelector(".start"),t=document.querySelector(".restart"),l=document.querySelector(".game-score"),s=document.querySelectorAll(".field-cell"),n=document.querySelector(".message-start"),i=document.querySelector(".message-lose"),r=document.querySelector(".message-win");let o=0,a={};const c=e=>a[e],f=(e,t=!0)=>{a[e]=t},d=function(e){let t=Math.floor(Math.random()*e.length),l=Math.floor(Math.random()*e.length);for(;t===l;)l=Math.floor(Math.random()*e.length);return[t,l]},L=function(e){return Array.from(e.classList).some(e=>e.startsWith("field-cell--"))},h=function(e){let t=Array.from(e.classList).join(" ").split("--");return t[t.length-1]},u=function(){let e=[];for(let t=0;t<s.length;t++)L(s[t])||e.push(t);if(e.length>0){let t=e[Math.floor(Math.random()*e.length)],l=.1>Math.random()?4:2;s[t].classList.add(`field-cell--${l}`),s[t].textContent=`${l}`}},m=function(e){for(let t=0;t<e.length;t++)if(!L(e[t]))return!1;return!0},g=function(e){for(let t=0;t<e.length;t++){let l=e[t];if(L(l)){let s=h(l);if(t-4>=0){let l=e[t-4];if(L(l)&&h(l)===s)return!0}if(t+4<e.length){let l=e[t+4];if(L(l)&&h(l)===s)return!0}if(t%4!=0){let l=e[t-1];if(L(l)&&h(l)===s)return!0}if((t+1)%4!=0){let l=e[t+1];if(L(l)&&h(l)===s)return!0}}}return!1},y=function(e){Array.from(r.classList).includes("hidden")&&m(e)&&!g(e)&&i.classList.remove("hidden")},$=function(e){2*e==2048&&r.classList.remove("hidden")},A=function(e){o+=2*e,l.textContent="",l.textContent=`${o}`},k=function(e){let t=!1;for(let l=0;l<e.length;l++){let s=e[l];if(L(s)&&l-4>=0){let n=l-4,i=h(s);for(;n>=0;){if(L(e[n])&&!c(n)){let t=Array.from(e[n].classList),l=Array.from(e[n+4].classList);if(t[t.length-1]!==l[l.length-1])break}else if(void 0!==c(n))break;let l=Array.from(e[n+4].classList);for(let t=0;t<l.length;t++){let s=l[t];"field-cell"!==s&&e[n+4].classList.remove(s)}if(e[n+4].textContent="",e[n].classList.contains(`field-cell--${i}`)){e[n].classList.remove(`field-cell--${i}`),e[n].classList.add(`field-cell--${2*i}`),e[n].textContent=`${2*i}`,f(n),A(i),t=!0,$(i);break}e[n].classList.add(`field-cell--${i}`),e[n].textContent=`${i}`,t=!0,n-=4}}}t&&u(),y(e),a={}},v=function(e){let t=!1;for(let l=e.length-1;l>=0;l--){let n=e[l];if(L(n)&&l+4<s.length){let i=l+4,r=h(n);for(;i<s.length;){if(L(e[i])&&!c(i)){let t=Array.from(e[i].classList),l=Array.from(e[i-4].classList);if(t[t.length-1]!==l[l.length-1])break}else if(void 0!==c(i))break;let l=Array.from(e[i-4].classList);for(let t=0;t<l.length;t++){let s=l[t];"field-cell"!==s&&e[i-4].classList.remove(s)}if(e[i-4].textContent="",e[i].classList.contains(`field-cell--${r}`)){e[i].classList.remove(`field-cell--${r}`),e[i].classList.add(`field-cell--${2*r}`),e[i].textContent=`${2*r}`,f(i),A(r),t=!0,$(r);break}e[i].classList.add(`field-cell--${r}`),e[i].textContent=`${r}`,t=!0,i+=4}}}t&&u(),y(e),a={}},x=function(e){let t=[0,4,8,12],l=!1;for(let s=0;s<e.length;s++){let n=e[s];if(L(n)){let i=s-1,r=h(n);for(;!t.includes(i+1)&&!t.includes(s);){if(L(e[i])&&!c(i)){let t=Array.from(e[i].classList),l=Array.from(e[i+1].classList);if(t[t.length-1]!==l[l.length-1])break}else if(void 0!==c(i))break;let t=Array.from(e[i+1].classList);for(let l=0;l<t.length;l++){let s=t[l];"field-cell"!==s&&e[i+1].classList.remove(s)}if(e[i+1].textContent="",e[i].classList.contains(`field-cell--${r}`)){e[i].classList.remove(`field-cell--${r}`),e[i].classList.add(`field-cell--${2*r}`),e[i].textContent=`${2*r}`,f(i),A(r),l=!0,$(r);break}e[i].classList.add(`field-cell--${r}`),e[i].textContent=`${r}`,l=!0,i-=1}}}l&&u(),y(e),a={}},C=function(e){let t=[3,7,11,15],l=!1;for(let s=e.length-1;s>=0;s--){let n=e[s];if(L(n)){let i=s+1,r=h(n);for(;!t.includes(i-1)&&!t.includes(s);){if(L(e[i])&&!c(i)){let t=Array.from(e[i].classList),l=Array.from(e[i-1].classList);if(t[t.length-1]!==l[l.length-1])break}else if(void 0!==c(i))break;let t=Array.from(e[i-1].classList);for(let l=0;l<t.length;l++){let s=t[l];"field-cell"!==s&&e[i-1].classList.remove(s)}if(e[i-1].textContent="",e[i].classList.contains(`field-cell--${r}`)){e[i].classList.remove(`field-cell--${r}`),e[i].classList.add(`field-cell--${2*r}`),e[i].textContent=`${2*r}`,f(i),A(r),l=!0,$(r);break}e[i].classList.add(`field-cell--${r}`),e[i].textContent=`${r}`,l=!0,i+=1}}}l&&u(),y(e),a={}};e.addEventListener("click",function(){e.classList.add("hidden"),t.classList.remove("hidden");let l=d(s);s[l[0]].classList.add("field-cell--2"),s[l[0]].textContent="2",s[l[1]].classList.add("field-cell--2"),s[l[1]].textContent="2",n.classList.add("hidden")}),t.addEventListener("click",()=>{location.reload()}),document.addEventListener("keydown",e=>{r.classList.contains("hidden")&&("ArrowUp"===e.key?k(s):"ArrowDown"===e.key?v(s):"ArrowLeft"===e.key?x(s):"ArrowRight"===e.key&&C(s))});
//# sourceMappingURL=index.8bad6697.js.map
